<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Title -->
  <title>APortal for Office 365</title>

  <!-- Required Meta Tags Always Come First -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Favicon -->
  <link rel="shortcut icon" href="/aportal/images/aportal.ico">
  <!-- 
<link rel="shortcut icon" href="/aportal/aportal.ico.css">
 -->
  
<link rel="stylesheet" href="/aportal/css/font-awesome/css/fontawesome-all.min.css">

  
<link rel="stylesheet" href="/aportal/css/animate.min.css">

  
<link rel="stylesheet" href="/aportal/css/hs.megamenu.css">

  
<link rel="stylesheet" href="/aportal/css/slick.css">

  
<link rel="stylesheet" href="/aportal/css/theme.css">

  
<link rel="stylesheet" href="/aportal/css/style.css">

  
<link rel="stylesheet" href="/aportal/css/docs.css">

  
<link rel="stylesheet" href="/aportal/css/prism.css">

  <!-- Google Fonts -->
  <link href="//fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" rel="stylesheet">
<meta name="generator" content="Hexo 4.1.1"><link rel="alternate" href="/aportal/atom.xml" title="APortal" type="application/atom+xml">
</head>
<body>
     <!-- ========== HEADER ========== -->
   <header id="header" class="u-header u-header--starter">
    <nav id="logoAndNav" class="navbar navbar-dark fixed-top bg-primary flex-nowrap p-0">
      <div class="col-md-3 col-xl-2 bg-md-primary-darker navbar-brand u-header__navbar-brand u-header__navbar-brand-center mr-0 py-3">
        <a class="u-header__navbar-brand-text-white d-flex" href="index.html" aria-label="Front">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 46 46" xml:space="preserve" style="margin-bottom: 0;">
            <path fill="#E1E4EA" opacity=".65" d="M23,41.1L23,41.1c-9.9,0-18-8-18-18l0,0c0-9.9,8-18,18-18h11.3c3.7,0,6.6,3,6.6,6.6v11.4C41,33,32.9,41.1,23,41.1z"/>
            <path class="fill-white" opacity=".5" d="M28,36L28,36c-9.9,0-18-8-18-18l0,0c0-9.9,8-18,18-18h11.3C43,0.1,46,3.1,46,6.7v11.4C46,28,38,36,28,36z"/>
            <path class="fill-white" opacity=".7" d="M18,46.1L18,46.1c-10,0-18-8-18-18l0,0c0-9.9,8-18,18-18h11.3c3.7,0,6.6,3,6.6,6.6v11.4C35.9,38.1,27.9,46.1,18,46.1z"/>
            <path class="fill-primary" d="M17.4,34.1V18.4h10.2v2.9h-6.4v3.4H26v2.9h-4.8v6.5H17.4z"/>
          </svg>
          <span class="u-header__navbar-brand-text">Front</span>
        </a>
        <a class="small ml-3" href="getting-started/changelog.html">
          <span class="badge badge-white">v2.9</span>
        </a>
      </div>

      <!-- Header Search -->
      <form class="form-inline input-group input-group-sm input-group-borderless d-none d-md-flex mr-auto ml-md-4" style="max-width: 500px;">
        <div class="input-group-prepend">
          <span class="input-group-text" id="docsSearch">
            <span class="fas fa-search"></span>
          </span>
        </div>
        <input class="js-hs-docs-search form-control pl-0" type="text" placeholder="Search..." aria-label="Search..." aria-describedby="docsSearch" data-url="assets/ajax/autocomplete-data-for-documentation-search.json">
      </form>
      <!-- End Header Search -->

      <!-- Header Links -->
      <ul class="navbar-nav u-header--starter text-nowrap flex-row align-items-center px-3 ml-0 ml-sm-3">
        <!-- <li class="nav-item">
          <a class="nav-link" href="#" title="Video Tuts" target="_blank">
            <span class="fab fa-youtube mr-sm-1"></span>
            <span class="d-none d-lg-inline-block">Video Tuts</span>
          </a>
        </li> -->
        <li class="nav-item ml-4">
          <a class="nav-link" href="../starter/index.html">
            <span class="fas fa-th mr-sm-1"></span>
            <span class="d-none d-lg-inline-block">Start Building</span>
          </a>
        </li>
        <li class="nav-item ml-3 ml-sm-5">
          <a class="btn btn-sm btn-light text-primary" href="../html/home/index.html" title="Live Preview">
            <span class="far fa-eye mr-sm-1"></span>
            Live Preview
          </a>
        </li>
      </ul>
      <!-- End Header Links -->
    </nav>
  </header>
  <!-- ========== END HEADER ========== -->
  <!-- ========== MAIN CONTENT ========== -->
  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar -->
      <nav class="col-md-3 col-xl-2 bg-light hs-sidebar navbar-expand-md">
        <div class="d-flex d-md-none justify-content-between mb-3">
          <!-- Sidebar Search -->
          <form class="col form-inline input-group-sm">
            <input class="js-hs-docs-search form-control form-control-sm w-100" type="text" placeholder="Search..." data-url="assets/ajax/autocomplete-data-for-documentation-search.json">
          </form>
          <!-- End Sidebar Search -->

          <!-- Responsive Toggle Button -->
          <button class="btn btn-link pl-0" type="button" data-toggle="collapse" data-target="#sidebar-nav" aria-controls="sidebar-nav" aria-expanded="false" aria-label="Toggle navigation">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 30 30" width="30" height="30" focusable="false">
              <path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M4 7h22M4 15h22M4 23h22"/>
            </svg>
          </button>
          <!-- End Responsive Toggle Button -->
        </div>

        <!-- Sidebar Nav -->
        <div class="collapse navbar-collapse" id="sidebar-nav">
          <div id="sidebarNav" class="js-scrollbar hs-sidebar-sticky">
            <!-- <h5 class="hs-sidebar__heading">Getting started</h5> -->
            <ul class="hs-sidebar__nav">
              <h5 class="hs-sidebar__heading"><a href="index.html">开始使用</a></h5><ul class="hs-sidebar__nav"><li class="hs-sidebar__item"><a href="preinstallation.html" class="hs-sidebar__link " >准备</a></li><li class="hs-sidebar__item"><a href="installation.html" class="hs-sidebar__link active" >安装</a></li><li class="hs-sidebar__item"><a href="initialization.html" class="hs-sidebar__link " >初始设置</a></li></ul><h5 class="hs-sidebar__heading"><a href="index.thml">示例项目</a></h5><ul class="hs-sidebar__nav"></ul><h5 class="hs-sidebar__heading"><a href="index.html">使用详解</a></h5><ul class="hs-sidebar__nav"><li class="hs-sidebar__item"><a href="orgchart.html" class="hs-sidebar__link " >组织结构管理</a></li><li class="hs-sidebar__item"><a href="workflow.html" class="hs-sidebar__link " >流程管理</a></li><li class="hs-sidebar__item"><a href="form.html" class="hs-sidebar__link " >表单设计</a></li><li class="hs-sidebar__item"><a href="development.html" class="hs-sidebar__link " >自定义开发</a></li></ul><h5 class="hs-sidebar__heading"><a href="index.html">常见问题</a></h5><ul class="hs-sidebar__nav"><li class="hs-sidebar__item"><a href="writting.html" class="hs-sidebar__link " >文档书写规范</a></li></ul>
            </ul>
          </div>
        </div>
        <!-- End Sidebar Nav -->
      </nav>
      <!-- End Sidebar -->

      <main class="col-md-9 col-xl-10 px-4 pt-0 pt-md-11 pb-7 ml-md-auto">
        <div class="row">
          <!-- Section Nav -->
          <div class="col-xl-2 order-xl-2 d-none d-xl-inline-block">
            <ul class="js-scroll-nav hd-doc-section-nav">
              <!-- <li class="hd-doc-section-nav-item active"><a href="#quick-start">Quick start</a></li>
              <li class="hd-doc-section-nav-item"><a href="#starter-template">Starter template</a></li>
              <li class="hd-doc-section-nav-item"><a href="#responsive-meta-tag">Responsive meta tag</a></li> -->
              <li class="hd-doc-section-nav-item"><a href="#导语">导语</a></li><li class="hd-doc-section-nav-item"><a href="#安装-APortal-PowerShell">安装 APortal.PowerShell</a></li><li class="hd-doc-section-nav-item"><a href="#安装模块前环境准备">安装模块前环境准备</a></li><li class="hd-doc-section-nav-item"><a href="#操作系统">操作系统</a></li><li class="hd-doc-section-nav-item"><a href="#PowerShell-版本">PowerShell 版本</a></li><li class="hd-doc-section-nav-item"><a href="#Net-Framework-版本">.Net Framework 版本</a></li><li class="hd-doc-section-nav-item"><a href="#SharePointPnPPowerShellOnline-版本">SharePointPnPPowerShellOnline 版本</a></li><li class="hd-doc-section-nav-item"><a href="#安装模块">安装模块</a></li><li class="hd-doc-section-nav-item"><a href="#使用-APortal-PowerShell">使用 APortal.PowerShell</a></li><li class="hd-doc-section-nav-item"><a href="#Set-APortalWeb">Set-APortalWeb</a></li>
            </ul>
          </div>
          <!-- End Section Nav -->

          <div class="col-xl-10 order-xl-1">
            <div class="hs-docs-content-divider">
              <h1>安装</h1>
            </div>
            <h2 id="导语" class="article-heading"><a href="#导语" class="headerlink" title="导语"></a>导语<a class="article-anchor" href="#导语" aria-hidden="true"></a></h2><p>在安装 APortal 之前，请仔细阅读本系列文章第一篇 ，根据实际需求谨慎选择安装环境，因为安装 APortal 会在相应的网站生成列表和推送网站资源，如果是已经存在的生产网站，可能会造成不可逆转的数据混淆。</p>
<h2 id="安装-APortal-PowerShell" class="article-heading"><a href="#安装-APortal-PowerShell" class="headerlink" title="安装 APortal.PowerShell"></a>安装 APortal.PowerShell<a class="article-anchor" href="#安装-APortal-PowerShell" aria-hidden="true"></a></h2><blockquote class="callout border-info bg-soft-info">
              <p>安装 APortal 使用 PowerShell 标准的包管理工具，我们针对 APortal 产品提供了一个叫做 <code>APortal.PowerShell</code>的 PowerShell 模块，且维护在 <a href="https://www.powershellgallery.com/packages/APortal.PowerShell" target="_blank" rel="noopener external nofollow noreferrer">PowerShellGallery</a> 上。</p>

            </blockquote>
<h3 id="安装模块前环境准备" class="article-heading"><a href="#安装模块前环境准备" class="headerlink" title="安装模块前环境准备"></a>安装模块前环境准备<a class="article-anchor" href="#安装模块前环境准备" aria-hidden="true"></a></h3><blockquote class="callout border-warning bg-soft-warning">
              <p><code>APortal.PowerShell</code> 模块依赖 <code>SharePointPnPPowerShellOnline</code>模块，因此目前只能在 Windows 环境下执行。</p>

            </blockquote>
<h4 id="操作系统" class="article-heading"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统<a class="article-anchor" href="#操作系统" aria-hidden="true"></a></h4><ul>
<li>Windows 10</li>
<li>Windows 2012 及以上</li>
</ul>
<h4 id="PowerShell-版本" class="article-heading"><a href="#PowerShell-版本" class="headerlink" title="PowerShell 版本"></a>PowerShell 版本<a class="article-anchor" href="#PowerShell-版本" aria-hidden="true"></a></h4><ul>
<li>5.0 </li>
<li>5.1</li>
</ul>
<h4 id="Net-Framework-版本" class="article-heading"><a href="#Net-Framework-版本" class="headerlink" title=".Net Framework 版本"></a>.Net Framework 版本<a class="article-anchor" href="#Net-Framework-版本" aria-hidden="true"></a></h4><ul>
<li>4.5 及以上</li>
<li>不支持 .NET Core</li>
</ul>
<h4 id="SharePointPnPPowerShellOnline-版本" class="article-heading"><a href="#SharePointPnPPowerShellOnline-版本" class="headerlink" title="SharePointPnPPowerShellOnline 版本"></a>SharePointPnPPowerShellOnline 版本<a class="article-anchor" href="#SharePointPnPPowerShellOnline-版本" aria-hidden="true"></a></h4><ul>
<li>3.13.1909</li>
<li>不需要手工安装，在安装 <code>APortal.Powershell</code> 包的时候会自动安装</li>
</ul>
<h3 id="安装模块" class="article-heading"><a href="#安装模块" class="headerlink" title="安装模块"></a>安装模块<a class="article-anchor" href="#安装模块" aria-hidden="true"></a></h3><blockquote class="callout border-info bg-soft-info">
              <p>准备好安装环境后，安装过程就十分简单，只需要运行安装命令即可。</p>

            </blockquote>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装最新版本</span></span><br><span class="line"><span class="built_in">Install-Module</span> <span class="literal">-Name</span> APortal.PowerShell</span><br><span class="line"><span class="comment"># 安装特定版本</span></span><br><span class="line"><span class="built_in">Install-Module</span> <span class="literal">-Name</span> APortal.PowerShell <span class="literal">-RequiredVersion</span> <span class="number">0.0</span>.<span class="number">9</span></span><br></pre></td></tr></table></figure>

<p>安装完成后，可以使用命令确认模块是否安装正确。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Module</span> <span class="literal">-Name</span> APortal.PowerShell <span class="literal">-ListAvailable</span></span><br></pre></td></tr></table></figure>

<h2 id="使用-APortal-PowerShell" class="article-heading"><a href="#使用-APortal-PowerShell" class="headerlink" title="使用 APortal.PowerShell"></a>使用 APortal.PowerShell<a class="article-anchor" href="#使用-APortal-PowerShell" aria-hidden="true"></a></h2><blockquote class="callout border-info bg-soft-info">
              <p>安装好 <code>APortal.PowerShell</code> 模块后，就可以使用模块包中提供的命令对网站进行设置 APortal。下面介绍 APortal.PowerShell 模块中包含的可用命令。</p>

            </blockquote>

<h3 id="Set-APortalWeb" class="article-heading"><a href="#Set-APortalWeb" class="headerlink" title="Set-APortalWeb"></a>Set-APortalWeb<a class="article-anchor" href="#Set-APortalWeb" aria-hidden="true"></a></h3><blockquote class="callout border-info bg-soft-info">
              <p>这是 <code>APortal.PowerShell</code> 模块中提供的最主要命令，用于设置SharePoint Online网站的 APortal 功能，会在用户输入的网站地址对应的网站上推送列表，网站资源，列表数据等一系列的网站数据。</p>

            </blockquote>

<ol>
<li><p>输入命令</p>
 <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 国际网站</span></span><br><span class="line"><span class="built_in">Set-APortalWeb</span> https://yourtenantname.sharepoint.com/sites/web/subweb</span><br><span class="line"><span class="comment"># 世纪互联网站</span></span><br><span class="line"><span class="built_in">Set-APortalWeb</span> https://yourtenantname.sharepoint.cn/sites/web/subweb</span><br></pre></td></tr></table></figure>
</li>
<li><p>在弹出的身份认证窗口中输入网站管理员身份信息</p>
<div width="100%" class="text-center"><img class="text-center class" height="80%" width="80%" src="images/media/15779286287197/15779316086252.jpg"></div>
<!-- ![-w967](images/media/15779286287197/15779316086252.jpg) -->
</li>
<li><p>确认管理员身份后命令开始执行，直到推送结束</p>
<div width="100%" class="text-center"><img class="text-center class" height="80%" width="80%" src="images/media/15779286287197/15779323142997.jpg"></div>
<!-- ![-w881](images/media/15779286287197/15779323142997.jpg) -->

</li>
</ol>

            <!-- Pager Nav -->
            <div class="row">
              <div class="col-sm-12">
                <a class="card shadow p-4 transition-3d-hover" href="getting-started/file-structures.html">
                  <span class="media align-items-center">
                    <span class="media-body">
                      <span class="d-block text-secondary">Previous</span>
                      <span class="d-block font-weight-semi-bold">File structures</span>
                    </span>
                    <span class="fas fa-arrow-right ml-2"></span>
                  </span>
                </a>
              </div>
            </div>
            <!-- End Pager Nav -->
          </div>
        </div>
      </main>
    </div>
  </div>
  <!-- ========== END MAIN CONTENT ========== -->

  <!-- Contact Us -->
  <div class="position-fixed bottom-0 right-0 bg-white p-3 m-1">
    <a class="btn btn-sm btn-outline-primary transition-3d-hover" target="_blank" href="https://htmlstream.com/contact-us" rel="external nofollow noreferrer">
      <span class="media align-items-center">
        <span class="far fa-envelope mr-2"></span>
        <span class="media-body">
          Contact Us
        </span>
      </span>
    </a>
  </div>
  <!-- End Contact Us -->
  <!-- ========== FOOTER ========== -->
<footer class="container text-center space-2">
  <!-- Logo -->
  <img src="/aportal/images/Aportal.svg" alt="" width="150px" height="80px">
  <!-- End Logo -->

  <p class="small text-muted mb-0">2012-2019 shuishan-tech.com. All rights reserved.</p>
</footer>
<!-- ========== END FOOTER ========== -->
   <!-- JS Global Compulsory -->
 
<script src="/aportal/js/vendor/jquery/dist/jquery.min.js"></script>

 
<script src="/aportal/js/vendor/jquery-migrate/dist/jquery-migrate.min.js"></script>

 
<script src="/aportal/js/vendor/popper.js/dist/umd/popper.min.js"></script>

 
<script src="/aportal/js/vendor/bootstrap/bootstrap.min.js"></script>

 
<script src="/aportal/js/vendor/hs-megamenu/src/hs.megamenu.js"></script>

 
<script src="/aportal/js/vendor/svg-injector/dist/svg-injector.min.js"></script>

 
<script src="/aportal/js/vendor/jquery-validation/dist/jquery.validate.min.js"></script>

 
<script src="/aportal/js/vendor/slick-carousel/slick/slick.js"></script>

 
<script src="/aportal/js/vendor/typed.js/lib/typed.min.js"></script>


 
<script src="/aportal/js/js/hs.core.js"></script>

 
<script src="/aportal/js/js/components/hs.header.js"></script>

 
<script src="/aportal/js/js/components/hs.unfold.js"></script>

 <!-- 
<script src="/aportal/js/js/components/hs.svg-injector.js"></script>
 -->
 
<script src="/aportal/js/js/components/hs.validation.js"></script>

 
<script src="/aportal/js/js/components/hs.slick-carousel.js"></script>

 
<script src="/aportal/js/js/components/hs.go-to.js"></script>

 
<script src="/aportal/js/js/components/hs.scroll-nav.js"></script>

 
<script src="/aportal/js/script.js"></script>


 <!-- JS Plugins Init. -->
 <script>
   $(window).on('load', function () {
    //   var typed = new Typed(".u-text-animation.u-text-animation--typing", {
    //     strings: ["简洁!", "高效!", "先进!"],
    //     typeSpeed: 60,
    //     loop: true,
    //     backSpeed: 25,
    //     backDelay: 1500
    //   });
    //  // initialization of HSMegaMenu component
    //  $('.js-mega-menu').HSMegaMenu({
    //    event: 'hover',
    //    pageContainer: $('.container'),
    //    breakpoint: 767.98,
    //    hideTimeOut: 0
    //  });

     // initialization of svg injector module
     $.HSCore.components.HSSVGIngector.init('.js-svg-injector');
   });

   $(document).on('ready', function () {
     // initialization of header
     $.HSCore.components.HSHeader.init($('#header'));

     // initialization of unfold component
     $.HSCore.components.HSUnfold.init($('[data-unfold-target]'), {
       afterOpen: function () {
         $(this).find('input[type="search"]').focus();
       }
     });

     // initialization of form validation
     $.HSCore.components.HSValidation.init('.js-validate', {
       rules: {
         confirmPassword: {
           equalTo: '#signupPassword'
         }
       }
     });

     // initialization of slick carousel
     $.HSCore.components.HSSlickCarousel.init('.js-slick-carousel');

     // initialization of go to
     $.HSCore.components.HSGoTo.init('.js-go-to');
   });
 </script>
</body>
</html>