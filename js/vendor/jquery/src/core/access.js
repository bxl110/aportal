define(["../core","../core/toType","../var/isFunction"],function(a,s,v){"use strict";var d=function(n,l,r,e,c,t,i){var o=0,u=n.length,f=null==r;if("object"===s(r))for(o in c=!0,r)d(n,l,o,r[o],!0,t,i);else if(void 0!==e&&(c=!0,v(e)||(i=!0),f&&(l=i?(l.call(n,e),null):(f=l,function(n,l,r){return f.call(a(n),r)})),l))for(;o<u;o++)l(n[o],r,i?e:e.call(n[o],o,l(n[o],r)));return c?n:f?l.call(n):u?l(n[0],r):t};return d});