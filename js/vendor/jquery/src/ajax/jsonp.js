define(["../core","../var/isFunction","./var/nonce","./var/rquery","../ajax"],function(p,c,a,l){"use strict";var i=[],j=/(=)\?(?=&|$)|\?\?/;p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var n=i.pop()||p.expando+"_"+a++;return this[n]=!0,n}}),p.ajaxPrefilter("json jsonp",function(n,a,o){var r,t,e,s=!1!==n.jsonp&&(j.test(n.url)?"url":"string"==typeof n.data&&0===(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&j.test(n.data)&&"data");if(s||"jsonp"===n.dataTypes[0])return r=n.jsonpCallback=c(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,s?n[s]=n[s].replace(j,"$1"+r):!1!==n.jsonp&&(n.url+=(l.test(n.url)?"&":"?")+n.jsonp+"="+r),n.converters["script json"]=function(){return e||p.error(r+" was not called"),e[0]},n.dataTypes[0]="json",t=window[r],window[r]=function(){e=arguments},o.always(function(){void 0===t?p(window).removeProp(r):window[r]=t,n[r]&&(n.jsonpCallback=a.jsonpCallback,i.push(r)),e&&c(t)&&t(e[0]),e=t=void 0}),"script"})});