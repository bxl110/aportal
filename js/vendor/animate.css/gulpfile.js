var autoprefixer=require("autoprefixer"),cssnano=require("cssnano"),fs=require("fs"),gulp=require("gulp"),concat=require("gulp-concat"),gutil=require("gulp-util"),header=require("gulp-header"),postcss=require("gulp-postcss"),rename=require("gulp-rename"),runSequence=require("run-sequence"),pkg=JSON.parse(fs.readFileSync("package.json")),activatedAnimations=activateAnimations(),opts={destPath:"./",concatName:"animate.css",autoprefixer:{browsers:["> 1%","last 2 versions","Firefox ESR"],cascade:!1},minRename:{suffix:".min"},banner:['@charset "UTF-8";\n',"/*!"," * <%= name %> -<%= homepage %>"," * Version - <%= version %>"," * Licensed under the MIT license - http://opensource.org/licenses/MIT"," *"," * Copyright (c) <%= new Date().getFullYear() %> <%= author.name %>"," */\n\n"].join("\n")};function activateAnimations(){var e,a,s,t=JSON.parse(fs.readFileSync("animate-config.json")),r=[],n=0;for(e in t)if(t.hasOwnProperty(e))for(s in a=t[e])a[s]&&(r.push("source/"+e+"/"+s+".css"),n+=1);return r.push("source/_base.css"),n?gutil.log(n+(1<n?" animations":" animation")+" activated."):gutil.log("No animations activated."),r}gulp.task("createCSS",function(){return gulp.src(activatedAnimations).pipe(concat(opts.concatName)).pipe(postcss([autoprefixer(opts.autoprefixer)])).pipe(gulp.dest(opts.destPath)).pipe(postcss([cssnano({reduceIdents:{keyframes:!1}})])).pipe(rename(opts.minRename)).pipe(gulp.dest(opts.destPath))}),gulp.task("addHeader",function(){return gulp.src("*.css").pipe(header(opts.banner,pkg)).pipe(gulp.dest(opts.destPath))}),gulp.task("default",gulp.series("createCSS","addHeader"));